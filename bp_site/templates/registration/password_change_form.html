{% extends "base.html" %}
{% block title %}Change Password | BP Heating & Plumbing{% endblock %}

{% block content %}
<section class="max-w-md mx-auto py-10">
  <h1 class="text-2xl font-bold mb-4">Change your password</h1>
  <p class="text-gray-700 mb-6 text-sm">
    Enter your current password, then choose a new one.
  </p>

  {# Show validation errors clearly #}
  {% if form.errors %}
    <div class="mb-4 bg-red-50 border border-red-200 text-red-700 text-sm rounded-lg p-3">
      <ul class="list-disc list-inside space-y-1">
        {# Field-specific errors (old password wrong, etc.) #}
        {% for field in form %}
          {% for error in field.errors %}
            <li>{{ error }}</li>
          {% endfor %}
        {% endfor %}
        {# Non-field errors (like passwords don’t match) #}
        {% for error in form.non_field_errors %}
          <li>{{ error }}</li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  <form method="post" class="space-y-4 bg-white p-6 rounded-xl shadow">
    {% csrf_token %}

    <div>
      <label class="block text-sm font-medium mb-1">Current password</label>
      {{ form.old_password }}
    </div>

    <div>
      <label class="block text-sm font-medium mb-1">New password</label>
      {{ form.new_password1 }}
    </div>

    <div>
      <label class="block text-sm font-medium mb-1">Confirm new password</label>
      {{ form.new_password2 }}
    </div>

    <button class="btn btn-primary btn-lg w-full">
      Change password
    </button>
  </form>

  <div class="mt-4 text-sm">
    <a href="/accounts/profile/" class="text-gray-600 hover:underline">
      ← Back to My Account
    </a>
  </div>
</section>
{% endblock %}
